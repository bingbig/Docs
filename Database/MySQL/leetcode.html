<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LeetCode | Bing</title>
    <meta name="description" content="文档空间">
    <link rel="icon" href="https://avatars.githubusercontent.com/bingbig">
    
    <link rel="preload" href="/assets/css/0.styles.16105da8.css" as="style"><link rel="preload" href="/assets/js/app.6b2c809f.js" as="script"><link rel="preload" href="/assets/js/29.ac24f130.js" as="script"><link rel="prefetch" href="/assets/js/10.f6176989.js"><link rel="prefetch" href="/assets/js/100.0768a1d7.js"><link rel="prefetch" href="/assets/js/101.ec9cf3e3.js"><link rel="prefetch" href="/assets/js/102.66ac4896.js"><link rel="prefetch" href="/assets/js/103.401d4b10.js"><link rel="prefetch" href="/assets/js/104.b2f962d3.js"><link rel="prefetch" href="/assets/js/105.9f9dc167.js"><link rel="prefetch" href="/assets/js/106.d22423d9.js"><link rel="prefetch" href="/assets/js/107.b627322d.js"><link rel="prefetch" href="/assets/js/108.52af3356.js"><link rel="prefetch" href="/assets/js/109.f12ba199.js"><link rel="prefetch" href="/assets/js/11.647dbc36.js"><link rel="prefetch" href="/assets/js/110.a2a4e6cb.js"><link rel="prefetch" href="/assets/js/111.94c3aaaa.js"><link rel="prefetch" href="/assets/js/112.8aea190a.js"><link rel="prefetch" href="/assets/js/113.1a7ccce8.js"><link rel="prefetch" href="/assets/js/114.db890620.js"><link rel="prefetch" href="/assets/js/115.84b8a260.js"><link rel="prefetch" href="/assets/js/116.7d5268cf.js"><link rel="prefetch" href="/assets/js/117.93c01afe.js"><link rel="prefetch" href="/assets/js/118.b25aa971.js"><link rel="prefetch" href="/assets/js/119.fa014286.js"><link rel="prefetch" href="/assets/js/12.84989b4b.js"><link rel="prefetch" href="/assets/js/120.3693ed0b.js"><link rel="prefetch" href="/assets/js/121.5c0f9771.js"><link rel="prefetch" href="/assets/js/122.109848a6.js"><link rel="prefetch" href="/assets/js/123.b8ee4cff.js"><link rel="prefetch" href="/assets/js/124.552dbc17.js"><link rel="prefetch" href="/assets/js/125.883a4e39.js"><link rel="prefetch" href="/assets/js/126.d89b69d2.js"><link rel="prefetch" href="/assets/js/127.c25e84b0.js"><link rel="prefetch" href="/assets/js/128.a452bcc0.js"><link rel="prefetch" href="/assets/js/129.5901a6f1.js"><link rel="prefetch" href="/assets/js/13.e9d34bfe.js"><link rel="prefetch" href="/assets/js/130.b4288184.js"><link rel="prefetch" href="/assets/js/131.bedcaf9c.js"><link rel="prefetch" href="/assets/js/132.5d4a9fa7.js"><link rel="prefetch" href="/assets/js/133.0e8935ab.js"><link rel="prefetch" href="/assets/js/134.51191e5b.js"><link rel="prefetch" href="/assets/js/135.52fc1365.js"><link rel="prefetch" href="/assets/js/136.12ce5b0c.js"><link rel="prefetch" href="/assets/js/137.bcd4b6f9.js"><link rel="prefetch" href="/assets/js/138.ceba826f.js"><link rel="prefetch" href="/assets/js/139.ab41ed03.js"><link rel="prefetch" href="/assets/js/14.bba95746.js"><link rel="prefetch" href="/assets/js/140.9195afbf.js"><link rel="prefetch" href="/assets/js/141.52de6632.js"><link rel="prefetch" href="/assets/js/142.5991a8c3.js"><link rel="prefetch" href="/assets/js/143.2eb890d2.js"><link rel="prefetch" href="/assets/js/144.d5731614.js"><link rel="prefetch" href="/assets/js/145.9ff0d3f7.js"><link rel="prefetch" href="/assets/js/146.62553ebb.js"><link rel="prefetch" href="/assets/js/147.5bb534ce.js"><link rel="prefetch" href="/assets/js/148.cfdcb4b2.js"><link rel="prefetch" href="/assets/js/149.ffb0f335.js"><link rel="prefetch" href="/assets/js/15.abdbf40e.js"><link rel="prefetch" href="/assets/js/150.3fa2add3.js"><link rel="prefetch" href="/assets/js/151.d9de380a.js"><link rel="prefetch" href="/assets/js/152.8820d383.js"><link rel="prefetch" href="/assets/js/153.1a7deb16.js"><link rel="prefetch" href="/assets/js/154.8a8d04d5.js"><link rel="prefetch" href="/assets/js/155.e596bd6e.js"><link rel="prefetch" href="/assets/js/156.f93ffc96.js"><link rel="prefetch" href="/assets/js/157.1d4e442a.js"><link rel="prefetch" href="/assets/js/158.5bfb982e.js"><link rel="prefetch" href="/assets/js/159.bbdebf53.js"><link rel="prefetch" href="/assets/js/16.23a09bd0.js"><link rel="prefetch" href="/assets/js/160.c5eae96d.js"><link rel="prefetch" href="/assets/js/161.a2241d1a.js"><link rel="prefetch" href="/assets/js/162.6285f306.js"><link rel="prefetch" href="/assets/js/163.7e424328.js"><link rel="prefetch" href="/assets/js/164.250fa087.js"><link rel="prefetch" href="/assets/js/165.6cf851be.js"><link rel="prefetch" href="/assets/js/166.17548140.js"><link rel="prefetch" href="/assets/js/167.81a169ac.js"><link rel="prefetch" href="/assets/js/168.21634c85.js"><link rel="prefetch" href="/assets/js/169.5cb2c187.js"><link rel="prefetch" href="/assets/js/17.26a3f651.js"><link rel="prefetch" href="/assets/js/170.842ec593.js"><link rel="prefetch" href="/assets/js/171.5fe1f306.js"><link rel="prefetch" href="/assets/js/172.57d63125.js"><link rel="prefetch" href="/assets/js/173.17e0e721.js"><link rel="prefetch" href="/assets/js/174.cd1048c8.js"><link rel="prefetch" href="/assets/js/175.2a9ed138.js"><link rel="prefetch" href="/assets/js/176.63b2df6e.js"><link rel="prefetch" href="/assets/js/177.ab26fd53.js"><link rel="prefetch" href="/assets/js/178.f2760c4a.js"><link rel="prefetch" href="/assets/js/179.581bbced.js"><link rel="prefetch" href="/assets/js/18.34749364.js"><link rel="prefetch" href="/assets/js/180.b390c5bb.js"><link rel="prefetch" href="/assets/js/181.385f7953.js"><link rel="prefetch" href="/assets/js/182.6cfb5179.js"><link rel="prefetch" href="/assets/js/183.4418d89d.js"><link rel="prefetch" href="/assets/js/184.f62d568a.js"><link rel="prefetch" href="/assets/js/185.652389ca.js"><link rel="prefetch" href="/assets/js/186.a15b5381.js"><link rel="prefetch" href="/assets/js/187.7e93ef83.js"><link rel="prefetch" href="/assets/js/188.188b9aa4.js"><link rel="prefetch" href="/assets/js/189.58d2adc8.js"><link rel="prefetch" href="/assets/js/19.33b6e0d9.js"><link rel="prefetch" href="/assets/js/190.f31d04b6.js"><link rel="prefetch" href="/assets/js/191.497232ef.js"><link rel="prefetch" href="/assets/js/192.a2045cfc.js"><link rel="prefetch" href="/assets/js/193.b430b41f.js"><link rel="prefetch" href="/assets/js/194.33a6fd3b.js"><link rel="prefetch" href="/assets/js/195.82574543.js"><link rel="prefetch" href="/assets/js/196.27161d59.js"><link rel="prefetch" href="/assets/js/197.e546d765.js"><link rel="prefetch" href="/assets/js/198.a3dc4687.js"><link rel="prefetch" href="/assets/js/199.7e1730f0.js"><link rel="prefetch" href="/assets/js/2.c4c7f0aa.js"><link rel="prefetch" href="/assets/js/20.be43276b.js"><link rel="prefetch" href="/assets/js/200.0ebceee7.js"><link rel="prefetch" href="/assets/js/201.ffa9096a.js"><link rel="prefetch" href="/assets/js/202.dea9f407.js"><link rel="prefetch" href="/assets/js/203.65f71b7b.js"><link rel="prefetch" href="/assets/js/204.6eccc640.js"><link rel="prefetch" href="/assets/js/205.37e32653.js"><link rel="prefetch" href="/assets/js/206.770c36ba.js"><link rel="prefetch" href="/assets/js/207.9cab62e1.js"><link rel="prefetch" href="/assets/js/208.e7eccf84.js"><link rel="prefetch" href="/assets/js/209.ce1441e1.js"><link rel="prefetch" href="/assets/js/21.7db2670e.js"><link rel="prefetch" href="/assets/js/210.e5a10df7.js"><link rel="prefetch" href="/assets/js/211.06c60da9.js"><link rel="prefetch" href="/assets/js/212.bf6984bf.js"><link rel="prefetch" href="/assets/js/213.c22eb113.js"><link rel="prefetch" href="/assets/js/214.3aab7d1f.js"><link rel="prefetch" href="/assets/js/215.5b082314.js"><link rel="prefetch" href="/assets/js/216.340588a3.js"><link rel="prefetch" href="/assets/js/217.9b3c8940.js"><link rel="prefetch" href="/assets/js/218.c38d9710.js"><link rel="prefetch" href="/assets/js/219.f21e2c60.js"><link rel="prefetch" href="/assets/js/22.e10869f6.js"><link rel="prefetch" href="/assets/js/220.38b3038d.js"><link rel="prefetch" href="/assets/js/221.ba426e65.js"><link rel="prefetch" href="/assets/js/222.265c024f.js"><link rel="prefetch" href="/assets/js/223.66962a7a.js"><link rel="prefetch" href="/assets/js/224.96713221.js"><link rel="prefetch" href="/assets/js/225.8915aaa4.js"><link rel="prefetch" href="/assets/js/226.6b285af0.js"><link rel="prefetch" href="/assets/js/227.b47d9853.js"><link rel="prefetch" href="/assets/js/228.9f6cbae9.js"><link rel="prefetch" href="/assets/js/23.1090bcef.js"><link rel="prefetch" href="/assets/js/24.42ca9d60.js"><link rel="prefetch" href="/assets/js/25.51778f79.js"><link rel="prefetch" href="/assets/js/26.fd01a47c.js"><link rel="prefetch" href="/assets/js/27.dacd7ea5.js"><link rel="prefetch" href="/assets/js/28.463ba231.js"><link rel="prefetch" href="/assets/js/3.803cd987.js"><link rel="prefetch" href="/assets/js/30.5fa4570d.js"><link rel="prefetch" href="/assets/js/31.8b53ab8a.js"><link rel="prefetch" href="/assets/js/32.2b71f979.js"><link rel="prefetch" href="/assets/js/33.377c2bbd.js"><link rel="prefetch" href="/assets/js/34.aa0b55c3.js"><link rel="prefetch" href="/assets/js/35.841f5ce9.js"><link rel="prefetch" href="/assets/js/36.b3151090.js"><link rel="prefetch" href="/assets/js/37.dd466b10.js"><link rel="prefetch" href="/assets/js/38.7631230b.js"><link rel="prefetch" href="/assets/js/39.bdbd4150.js"><link rel="prefetch" href="/assets/js/4.f376888f.js"><link rel="prefetch" href="/assets/js/40.bd0aba4d.js"><link rel="prefetch" href="/assets/js/41.fb240faa.js"><link rel="prefetch" href="/assets/js/42.573f42b6.js"><link rel="prefetch" href="/assets/js/43.f3ab36d0.js"><link rel="prefetch" href="/assets/js/44.d72fbc07.js"><link rel="prefetch" href="/assets/js/45.a2c94371.js"><link rel="prefetch" href="/assets/js/46.e22c3a4d.js"><link rel="prefetch" href="/assets/js/47.699bd039.js"><link rel="prefetch" href="/assets/js/48.643e09ec.js"><link rel="prefetch" href="/assets/js/49.5593dccf.js"><link rel="prefetch" href="/assets/js/5.aa717142.js"><link rel="prefetch" href="/assets/js/50.bfb98f44.js"><link rel="prefetch" href="/assets/js/51.bb668b1f.js"><link rel="prefetch" href="/assets/js/52.a1e166b8.js"><link rel="prefetch" href="/assets/js/53.d9d4ab66.js"><link rel="prefetch" href="/assets/js/54.365f1440.js"><link rel="prefetch" href="/assets/js/55.aa7a99bc.js"><link rel="prefetch" href="/assets/js/56.f71d3bdc.js"><link rel="prefetch" href="/assets/js/57.c22489ff.js"><link rel="prefetch" href="/assets/js/58.961cb551.js"><link rel="prefetch" href="/assets/js/59.625c571b.js"><link rel="prefetch" href="/assets/js/6.2c0dbfe9.js"><link rel="prefetch" href="/assets/js/60.7cad7d61.js"><link rel="prefetch" href="/assets/js/61.3ab2039b.js"><link rel="prefetch" href="/assets/js/62.ebbcc7a8.js"><link rel="prefetch" href="/assets/js/63.022f6fe1.js"><link rel="prefetch" href="/assets/js/64.cfc0dcb3.js"><link rel="prefetch" href="/assets/js/65.4f892233.js"><link rel="prefetch" href="/assets/js/66.6e6574c2.js"><link rel="prefetch" href="/assets/js/67.40fb186e.js"><link rel="prefetch" href="/assets/js/68.54858ca7.js"><link rel="prefetch" href="/assets/js/69.e028e80f.js"><link rel="prefetch" href="/assets/js/7.3d66d209.js"><link rel="prefetch" href="/assets/js/70.9c1a0d51.js"><link rel="prefetch" href="/assets/js/71.9e6467f5.js"><link rel="prefetch" href="/assets/js/72.60bfce27.js"><link rel="prefetch" href="/assets/js/73.9ec43056.js"><link rel="prefetch" href="/assets/js/74.0aa6072f.js"><link rel="prefetch" href="/assets/js/75.865d7dda.js"><link rel="prefetch" href="/assets/js/76.fc1f0140.js"><link rel="prefetch" href="/assets/js/77.51e20bb9.js"><link rel="prefetch" href="/assets/js/78.93dbf54e.js"><link rel="prefetch" href="/assets/js/79.7a5b89c7.js"><link rel="prefetch" href="/assets/js/8.5b98a3a4.js"><link rel="prefetch" href="/assets/js/80.d2e23095.js"><link rel="prefetch" href="/assets/js/81.8b16c2f7.js"><link rel="prefetch" href="/assets/js/82.db077248.js"><link rel="prefetch" href="/assets/js/83.360d0cb4.js"><link rel="prefetch" href="/assets/js/84.50dadff3.js"><link rel="prefetch" href="/assets/js/85.0111e9a1.js"><link rel="prefetch" href="/assets/js/86.b2425a36.js"><link rel="prefetch" href="/assets/js/87.63aebc19.js"><link rel="prefetch" href="/assets/js/88.479041f7.js"><link rel="prefetch" href="/assets/js/89.769c409d.js"><link rel="prefetch" href="/assets/js/9.520db884.js"><link rel="prefetch" href="/assets/js/90.2ec7b507.js"><link rel="prefetch" href="/assets/js/91.9cae6dae.js"><link rel="prefetch" href="/assets/js/92.7863085a.js"><link rel="prefetch" href="/assets/js/93.3023daa8.js"><link rel="prefetch" href="/assets/js/94.7ffa85cb.js"><link rel="prefetch" href="/assets/js/95.b8b1e5dc.js"><link rel="prefetch" href="/assets/js/96.79ba50a3.js"><link rel="prefetch" href="/assets/js/97.988cb9bc.js"><link rel="prefetch" href="/assets/js/98.95938b5a.js"><link rel="prefetch" href="/assets/js/99.4842d35c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.16105da8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Bing</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">归档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/clang/content.html" class="nav-link">C</a></li><li class="dropdown-item"><!----> <a href="/PHP/content.html" class="nav-link">PHP</a></li><li class="dropdown-item"><!----> <a href="/GO/content.html" class="nav-link">GO</a></li><li class="dropdown-item"><!----> <a href="/network/content.html" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/datastructure/content.html" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/algorithms/content.html" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/Database/content.html" class="nav-link">数据库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">专栏</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/topics/redis/content.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/topics/centent.html" class="nav-link">更多...</a></li></ul></div></div><div class="nav-item"><a href="/gossip/content.html" class="nav-link">杂谈</a></div><div class="nav-item"><a href="/aboutme.html" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">归档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/clang/content.html" class="nav-link">C</a></li><li class="dropdown-item"><!----> <a href="/PHP/content.html" class="nav-link">PHP</a></li><li class="dropdown-item"><!----> <a href="/GO/content.html" class="nav-link">GO</a></li><li class="dropdown-item"><!----> <a href="/network/content.html" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/datastructure/content.html" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/algorithms/content.html" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/Database/content.html" class="nav-link">数据库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">专栏</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/topics/redis/content.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/topics/centent.html" class="nav-link">更多...</a></li></ul></div></div><div class="nav-item"><a href="/gossip/content.html" class="nav-link">杂谈</a></div><div class="nav-item"><a href="/aboutme.html" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Database/content.html" class="sidebar-link">数据库</a></li><li><a href="/Database/MySQL/leetcode.html" class="active sidebar-link">LeetCode</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_175-combine-two-tables" class="sidebar-link">175. Combine Two Tables</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_176-second-highest-salary" class="sidebar-link">176. Second Highest Salary</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-2" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_177-nth-highest-salary" class="sidebar-link">177. Nth Highest Salary</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-3" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_180-consecutive-numbers" class="sidebar-link">180. Consecutive Numbers</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-4" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_181-employees-earning-more-than-their-managers" class="sidebar-link">181. Employees Earning More Than Their Managers</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-5" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_182-duplicate-emails" class="sidebar-link">182. Duplicate Emails</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-6" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_183-customers-who-never-order" class="sidebar-link">183. Customers Who Never Order</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-7" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_184-department-highest-salary" class="sidebar-link">184. Department Highest Salary</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-8" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_196-delete-duplicate-emails" class="sidebar-link">196. Delete Duplicate Emails</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-9" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_197-rising-temperature" class="sidebar-link">197. Rising Temperature</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-10" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_595-big-countries" class="sidebar-link">595. Big Countries</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-11" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_620-not-boring-movies" class="sidebar-link">620. Not Boring Movies</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-12" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_627-swap-salary" class="sidebar-link">627. Swap Salary</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-13" class="sidebar-link">Solutions</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#_596-classes-more-than-5-students" class="sidebar-link">596. Classes More Than 5 Students</a></li><li class="sidebar-sub-header"><a href="/Database/MySQL/leetcode.html#solutions-14" class="sidebar-link">Solutions</a></li></ul></li><li><a href="/Database/MySQL/optimization.html" class="sidebar-link">MySQL及索引优化</a></li><li><a href="/Database/Redis/Redis.html" class="sidebar-link">Redis</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="leetcode"><a href="#leetcode" aria-hidden="true" class="header-anchor">#</a> LeetCode</h1> <p>最近刷LeetCode DataBase，顺便把答案贴出来，供以后复习参考。</p> <blockquote><p>Contents</p></blockquote> <p>[TOC]</p> <h2 id="_175-combine-two-tables"><a href="#_175-combine-two-tables" aria-hidden="true" class="header-anchor">#</a> 175. Combine Two Tables</h2> <p>Table: Person</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+-------------+--------+
| Column Name | Type    |
+-------------+--------+
| PersonId    | int     |
| FirstName   | varchar |
| LastName    | varchar |
+-------------+--------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>PersonId is the primary key column for this table.
Table: Address</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+-------------+--------+
| Column Name | Type    |
+-------------+--------+
| AddressId   | int     |
| PersonId    | int     |
| City        | varchar |
| State       | varchar |
+-------------+--------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>AddressId is the primary key column for this table.</p> <p>Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>FirstName, LastName, City, State
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="solutions"><a href="#solutions" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	FirstName<span class="token punctuation">,</span> LastName<span class="token punctuation">,</span> City<span class="token punctuation">,</span> State
<span class="token keyword">FROM</span>
	Person <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Address
<span class="token keyword">ON</span>
	Person<span class="token punctuation">.</span>PersonId <span class="token operator">=</span> Address<span class="token punctuation">.</span>PersonId
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><hr> <h2 id="_176-second-highest-salary"><a href="#_176-second-highest-salary" aria-hidden="true" class="header-anchor">#</a> 176. Second Highest Salary</h2> <p>Write a SQL query to get the second highest salary from the Employee table.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>For example, given the above Employee table, the query should return 200 as the second highest salary. If there is no second highest salary, then the query should return null.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="solutions-2"><a href="#solutions-2" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
    Salary <span class="token keyword">AS</span> SecondHighestSalary
<span class="token keyword">FROM</span>
    Employee
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Salary <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">1</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
            Salary
        <span class="token keyword">FROM</span>
            Employee
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Salary <span class="token keyword">DESC</span>
        <span class="token keyword">LIMIT</span> <span class="token number">1</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> SecondHighestSalary
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    IFNULL<span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Salary
       <span class="token keyword">FROM</span> Employee
       <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Salary <span class="token keyword">DESC</span>
        <span class="token keyword">LIMIT</span> <span class="token number">1</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token boolean">NULL</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> SecondHighestSalary
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><hr> <h2 id="_177-nth-highest-salary"><a href="#_177-nth-highest-salary" aria-hidden="true" class="header-anchor">#</a> 177. Nth Highest Salary</h2> <p>Write a SQL query to get the nth highest salary from the Employee table.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>For example, given the above Employee table, the nth highest salary where n = 2 is 200. If there is no nth highest salary, then the query should
return null.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+------------------------+
| getNthHighestSalary(2) |
+------------------------+
| 200                    |
+------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="solutions-3"><a href="#solutions-3" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> getNthHighestSalary<span class="token punctuation">(</span>N <span class="token keyword">INT</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">INT</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">DECLARE</span> M <span class="token keyword">INT</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> M <span class="token operator">=</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">RETURN</span> <span class="token punctuation">(</span>
      <span class="token comment"># Write your MySQL query statement below.</span>
      <span class="token keyword">select</span> IFNULL<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> Salary <span class="token keyword">from</span> Employee <span class="token keyword">order</span> <span class="token keyword">by</span> Salary <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">1</span> <span class="token keyword">offset</span> M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr> <h2 id="_180-consecutive-numbers"><a href="#_180-consecutive-numbers" aria-hidden="true" class="header-anchor">#</a> 180. Consecutive Numbers</h2> <p>Write a SQL query to find all numbers that appear at least three times consecutively.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+-----+
| Id | Num |
+----+-----+
| 1  |  1  |
| 2  |  1  |
| 3  |  1  |
| 4  |  2  |
| 5  |  1  |
| 6  |  2  |
| 7  |  2  |
+----+-----+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>For example, given the above Logs table, 1 is the only number that appears consecutively for at least three times.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+-----------------+
| ConsecutiveNums |
+-----------------+
| 1               |
+-----------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="solutions-4"><a href="#solutions-4" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span>
    Logs l1<span class="token punctuation">,</span>
    Logs l2<span class="token punctuation">,</span>
    Logs l3
<span class="token keyword">WHERE</span>
    l1<span class="token punctuation">.</span>Id <span class="token operator">=</span> l2<span class="token punctuation">.</span>Id <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token operator">AND</span> l2<span class="token punctuation">.</span>Id <span class="token operator">=</span> l3<span class="token punctuation">.</span>Id <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token operator">AND</span> l1<span class="token punctuation">.</span>Num <span class="token operator">=</span> l2<span class="token punctuation">.</span>Num
    <span class="token operator">AND</span> l2<span class="token punctuation">.</span>Num <span class="token operator">=</span> l3<span class="token punctuation">.</span>Num
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
    l1<span class="token punctuation">.</span>Num <span class="token keyword">AS</span> ConsecutiveNums
<span class="token keyword">FROM</span>
    Logs l1<span class="token punctuation">,</span>
    Logs l2<span class="token punctuation">,</span>
    Logs l3
<span class="token keyword">WHERE</span>
    l1<span class="token punctuation">.</span>Id <span class="token operator">=</span> l2<span class="token punctuation">.</span>Id <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token operator">AND</span> l2<span class="token punctuation">.</span>Id <span class="token operator">=</span> l3<span class="token punctuation">.</span>Id <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token operator">AND</span> l1<span class="token punctuation">.</span>Num <span class="token operator">=</span> l2<span class="token punctuation">.</span>Num
    <span class="token operator">AND</span> l2<span class="token punctuation">.</span>Num <span class="token operator">=</span> l3<span class="token punctuation">.</span>Num
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><hr> <h2 id="_181-employees-earning-more-than-their-managers"><a href="#_181-employees-earning-more-than-their-managers" aria-hidden="true" class="header-anchor">#</a> 181. Employees Earning More Than Their Managers</h2> <p>The Employee table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+-------+--------+-----------+
| Id | Name  | Salary | ManagerId |
+----+-------+--------+-----------+
| 1  | Joe   | 70000  | 3         |
| 2  | Henry | 80000  | 4         |
| 3  | Sam   | 60000  | NULL      |
| 4  | Max   | 90000  | NULL      |
+----+-------+--------+-----------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Given the Employee table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----------+
| Employee |
+----------+
| Joe      |
+----------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="solutions-5"><a href="#solutions-5" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    a<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> <span class="token string">'Employee'</span>
<span class="token keyword">FROM</span>
    Employee <span class="token keyword">AS</span> a<span class="token punctuation">,</span>
    Employee <span class="token keyword">AS</span> b
<span class="token keyword">WHERE</span>
    a<span class="token punctuation">.</span>ManagerId <span class="token operator">=</span> b<span class="token punctuation">.</span>Id
        <span class="token operator">AND</span> a<span class="token punctuation">.</span>Salary <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>Salary
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
     a<span class="token punctuation">.</span>NAME <span class="token keyword">AS</span> Employee
<span class="token keyword">FROM</span> Employee <span class="token keyword">AS</span> a <span class="token keyword">JOIN</span> Employee <span class="token keyword">AS</span> b
     <span class="token keyword">ON</span> a<span class="token punctuation">.</span>ManagerId <span class="token operator">=</span> b<span class="token punctuation">.</span>Id
     <span class="token operator">AND</span> a<span class="token punctuation">.</span>Salary <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>Salary
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><hr> <h2 id="_182-duplicate-emails"><a href="#_182-duplicate-emails" aria-hidden="true" class="header-anchor">#</a> 182. Duplicate Emails</h2> <p>Write a SQL query to find all duplicate emails in a table named Person.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+---------+
| Id | Email   |
+----+---------+
| 1  | a@b.com |
| 2  | c@d.com |
| 3  | a@b.com |
+----+---------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>For example, your query should return the following for the above table:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+---------+
| Email   |
+---------+
| a@b.com |
+---------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Note: All emails are in lowercase.
​</p> <h2 id="solutions-6"><a href="#solutions-6" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	Email
<span class="token keyword">FROM</span>
	<span class="token punctuation">(</span>
		<span class="token keyword">SELECT</span> Email<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>Email<span class="token punctuation">)</span> <span class="token keyword">AS</span> num
		<span class="token keyword">FROM</span> Person
		<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Email
	<span class="token punctuation">)</span> <span class="token keyword">AS</span> statistic
	<span class="token keyword">WHERE</span> num <span class="token operator">&gt;</span> <span class="token number">1</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	Email
<span class="token keyword">FROM</span>
	Person
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	Email
<span class="token keyword">HAVING</span> 
	<span class="token function">count</span><span class="token punctuation">(</span>Email<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr> <h2 id="_183-customers-who-never-order"><a href="#_183-customers-who-never-order" aria-hidden="true" class="header-anchor">#</a> 183. Customers Who Never Order</h2> <p>Suppose that a website contains two tables, the Customers table and the Orders table. Write a SQL query to find all customers who never order anything.
Table: Customers.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+-------+
| Id | Name  |
+----+-------+
| 1  | Joe   |
| 2  | Henry |
| 3  | Sam   |
| 4  | Max   |
+----+-------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Table: Orders.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+------------+
| Id | CustomerId |
+----+------------+
| 1  | 3          |
| 2  | 1          |
+----+------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Using the above tables as example, return the following:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+-----------+
| Customers |
+-----------+
| Henry     |
| Max       |
+-----------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="solutions-7"><a href="#solutions-7" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	customers<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token string">'Customers'</span>
<span class="token keyword">FROM</span>
	customers
<span class="token keyword">WHERE</span>
	customers<span class="token punctuation">.</span>id <span class="token operator">NOT</span> <span class="token operator">IN</span>
<span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> customerid <span class="token keyword">FROM</span> orders
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    Name <span class="token keyword">AS</span> Customers
<span class="token keyword">FROM</span> 
    Customers 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 
    Orders 
<span class="token keyword">ON</span>
    Customers<span class="token punctuation">.</span>Id <span class="token operator">=</span> Orders<span class="token punctuation">.</span>CustomerId
<span class="token keyword">WHERE</span>
    Orders<span class="token punctuation">.</span>CustomerId <span class="token operator">IS</span> <span class="token boolean">NULL</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr> <h2 id="_184-department-highest-salary"><a href="#_184-department-highest-salary" aria-hidden="true" class="header-anchor">#</a> 184. Department Highest Salary</h2> <p>The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">+</span><span class="token comment">----+-------+--------+--------------+</span>
<span class="token operator">|</span> Id <span class="token operator">|</span> Name  <span class="token operator">|</span> Salary <span class="token operator">|</span> DepartmentId <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-------+--------+--------------+</span>
<span class="token operator">|</span> <span class="token number">1</span>  <span class="token operator">|</span> Joe   <span class="token operator">|</span> <span class="token number">70000</span>  <span class="token operator">|</span> <span class="token number">1</span>            <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>  <span class="token operator">|</span> Henry <span class="token operator">|</span> <span class="token number">80000</span>  <span class="token operator">|</span> <span class="token number">2</span>            <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">3</span>  <span class="token operator">|</span> Sam   <span class="token operator">|</span> <span class="token number">60000</span>  <span class="token operator">|</span> <span class="token number">2</span>            <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">4</span>  <span class="token operator">|</span> Max   <span class="token operator">|</span> <span class="token number">90000</span>  <span class="token operator">|</span> <span class="token number">1</span>            <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-------+--------+--------------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>The Department table holds all departments of the company.</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">+</span><span class="token comment">----+----------+</span>
<span class="token operator">|</span> Id <span class="token operator">|</span> Name     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+</span>
<span class="token operator">|</span> <span class="token number">1</span>  <span class="token operator">|</span> IT       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>  <span class="token operator">|</span> Sales    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, Max has the highest salary in the IT department and Henry has the highest salary in the Sales department.</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">+</span><span class="token comment">------------+----------+--------+</span>
<span class="token operator">|</span> Department <span class="token operator">|</span> Employee <span class="token operator">|</span> Salary <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------+----------+--------+</span>
<span class="token operator">|</span> IT         <span class="token operator">|</span> Max      <span class="token operator">|</span> <span class="token number">90000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> Sales      <span class="token operator">|</span> Henry    <span class="token operator">|</span> <span class="token number">80000</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------+----------+--------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="solutions-8"><a href="#solutions-8" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    Department<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token string">'Department'</span><span class="token punctuation">,</span>
    Employee<span class="token punctuation">.</span>name <span class="token keyword">AS</span> <span class="token string">'Employee'</span><span class="token punctuation">,</span>
    Salary
<span class="token keyword">FROM</span>
    Employee
        <span class="token keyword">JOIN</span>
    Department <span class="token keyword">ON</span> Employee<span class="token punctuation">.</span>DepartmentId <span class="token operator">=</span> Department<span class="token punctuation">.</span>Id
<span class="token keyword">WHERE</span>
    <span class="token punctuation">(</span>Employee<span class="token punctuation">.</span>DepartmentId <span class="token punctuation">,</span> Salary<span class="token punctuation">)</span> <span class="token operator">IN</span>
    <span class="token punctuation">(</span>   <span class="token keyword">SELECT</span>
            DepartmentId<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span>
        <span class="token keyword">FROM</span>
            Employee
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> DepartmentId
    <span class="token punctuation">)</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    D<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> Department<span class="token punctuation">,</span> E<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> Employee<span class="token punctuation">,</span> E<span class="token punctuation">.</span>Salary <span class="token keyword">AS</span> Salary
<span class="token keyword">FROM</span>
    Employee E<span class="token punctuation">,</span> Department D<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> DepartmentId<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>Salary<span class="token punctuation">)</span> <span class="token keyword">AS</span> maxS <span class="token keyword">FROM</span> Employee <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> DepartmentId<span class="token punctuation">)</span> T
<span class="token keyword">WHERE</span>
    E<span class="token punctuation">.</span>Salary <span class="token operator">=</span> T<span class="token punctuation">.</span>maxS <span class="token operator">AND</span>
    E<span class="token punctuation">.</span>DepartmentId <span class="token operator">=</span> T<span class="token punctuation">.</span>DepartmentId <span class="token operator">AND</span>
    E<span class="token punctuation">.</span>DepartmentId <span class="token operator">=</span> D<span class="token punctuation">.</span>Id
 <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr> <h2 id="_196-delete-duplicate-emails"><a href="#_196-delete-duplicate-emails" aria-hidden="true" class="header-anchor">#</a> 196. Delete Duplicate Emails</h2> <p>Write a SQL query to delete all duplicate email entries in a table named Person, keeping only unique emails based on its smallest Id.</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">+</span><span class="token comment">----+------------------+</span>
<span class="token operator">|</span> Id <span class="token operator">|</span> Email            <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+------------------+</span>
<span class="token operator">|</span> <span class="token number">1</span>  <span class="token operator">|</span> john<span class="token variable">@example.com</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>  <span class="token operator">|</span> bob<span class="token variable">@example.com</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">3</span>  <span class="token operator">|</span> john<span class="token variable">@example.com</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+------------------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Id is the primary key column for this table.
For example, after running your query, the above Person table should have the following rows:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">+</span><span class="token comment">----+------------------+</span>
<span class="token operator">|</span> Id <span class="token operator">|</span> Email            <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+------------------+</span>
<span class="token operator">|</span> <span class="token number">1</span>  <span class="token operator">|</span> john<span class="token variable">@example.com</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>  <span class="token operator">|</span> bob<span class="token variable">@example.com</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+------------------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="solutions-9"><a href="#solutions-9" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> p1<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> Person p1<span class="token punctuation">,</span>
    Person p2
<span class="token keyword">WHERE</span>
    p1<span class="token punctuation">.</span>Email <span class="token operator">=</span> p2<span class="token punctuation">.</span>Email <span class="token operator">AND</span> p1<span class="token punctuation">.</span>Id <span class="token operator">&gt;</span> p2<span class="token punctuation">.</span>Id
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DELETE</span> p1 <span class="token keyword">FROM</span> Person p1<span class="token punctuation">,</span>
    Person p2
<span class="token keyword">WHERE</span>
    p1<span class="token punctuation">.</span>Email <span class="token operator">=</span> p2<span class="token punctuation">.</span>Email <span class="token operator">AND</span> p1<span class="token punctuation">.</span>Id <span class="token operator">&gt;</span> p2<span class="token punctuation">.</span>Id
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr> <h2 id="_197-rising-temperature"><a href="#_197-rising-temperature" aria-hidden="true" class="header-anchor">#</a> 197. Rising Temperature</h2> <p>Given a <code>Weather</code> table, write a SQL query to find all dates' Ids with higher temperature compared to its previous (yesterday's) dates.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+---------+------------+------------------+
| Id(INT) | Date(DATE) | Temperature(INT) |
+---------+------------+------------------+
|       1 | 2015-01-01 |               10 |
|       2 | 2015-01-02 |               25 |
|       3 | 2015-01-03 |               20 |
|       4 | 2015-01-04 |               30 |
+---------+------------+------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>For example, return the following Ids for the above Weather table:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+
| Id |
+----+
|  2 |
|  4 |
+----+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="solutions-10"><a href="#solutions-10" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    weather<span class="token punctuation">.</span>id <span class="token keyword">AS</span> <span class="token string">'Id'</span>
<span class="token keyword">FROM</span>
    weather
        <span class="token keyword">JOIN</span>
    weather w <span class="token keyword">ON</span> DATEDIFF<span class="token punctuation">(</span>weather<span class="token punctuation">.</span><span class="token keyword">date</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span><span class="token keyword">date</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token operator">AND</span> weather<span class="token punctuation">.</span>Temperature <span class="token operator">&gt;</span> w<span class="token punctuation">.</span>Temperature
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    t2<span class="token punctuation">.</span>Id
<span class="token keyword">FROM</span>
    Weather t1<span class="token punctuation">,</span> Weather t2
<span class="token keyword">WHERE</span>
    t2<span class="token punctuation">.</span><span class="token keyword">Date</span> <span class="token operator">=</span> DATE_ADD<span class="token punctuation">(</span>t1<span class="token punctuation">.</span><span class="token keyword">Date</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">day</span><span class="token punctuation">)</span> <span class="token operator">AND</span> t2<span class="token punctuation">.</span>Temperature <span class="token operator">&gt;</span> t1<span class="token punctuation">.</span>Temperature
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><hr> <h2 id="_595-big-countries"><a href="#_595-big-countries" aria-hidden="true" class="header-anchor">#</a> 595. Big Countries</h2> <p>There is a table <code>World</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+-----------------+------------+------------+--------------+---------------+
| name            | continent  | area       | population   | gdp           |
+-----------------+------------+------------+--------------+---------------+
| Afghanistan     | Asia       | 652230     | 25500100     | 20343000      |
| Albania         | Europe     | 28748      | 2831741      | 12960000      |
| Algeria         | Africa     | 2381741    | 37100000     | 188681000     |
| Andorra         | Europe     | 468        | 78115        | 3712000       |
| Angola          | Africa     | 1246700    | 20609294     | 100990000     |
+-----------------+------------+------------+--------------+---------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>A country is big if it has an area of bigger than 3 million square km or a population of more than 25 million.
Write a SQL solution to output big countries' name, population and area.
For example, according to the above table, we should output:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+--------------+-------------+--------------+
| name         | population  | area         |
+--------------+-------------+--------------+
| Afghanistan  | 25500100    | 652230       |
| Algeria      | 37100000    | 2381741      |
+--------------+-------------+--------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="solutions-11"><a href="#solutions-11" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    name<span class="token punctuation">,</span> population<span class="token punctuation">,</span> area
<span class="token keyword">FROM</span>
    world
<span class="token keyword">WHERE</span>
    area <span class="token operator">&gt;</span> <span class="token number">3000000</span>

<span class="token keyword">UNION</span>

<span class="token keyword">SELECT</span>
    name<span class="token punctuation">,</span> population<span class="token punctuation">,</span> area
<span class="token keyword">FROM</span>
    world
<span class="token keyword">WHERE</span>
    population <span class="token operator">&gt;</span> <span class="token number">25000000</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    name<span class="token punctuation">,</span> population<span class="token punctuation">,</span> area
<span class="token keyword">FROM</span>
    world
<span class="token keyword">WHERE</span>
    area <span class="token operator">&gt;</span> <span class="token number">3000000</span> <span class="token operator">OR</span> population <span class="token operator">&gt;</span> <span class="token number">25000000</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><hr> <h2 id="_620-not-boring-movies"><a href="#_620-not-boring-movies" aria-hidden="true" class="header-anchor">#</a> 620. Not Boring Movies</h2> <p>X city opened a new cinema, many people would like to go to this cinema. The cinema also gives out a poster indicating the movies’ ratings and descriptions.
Please write a SQL query to output movies with an odd numbered ID and a description that is not 'boring'. Order the result by rating.</p> <p>For example, table <code>cinema</code>:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+---------+-----------+--------------+-----------+
|   id    | movie     |  description |  rating   |
+---------+-----------+--------------+-----------+
|   1     | War       |   great 3D   |   8.9     |
|   2     | Science   |   fiction    |   8.5     |
|   3     | irish     |   boring     |   6.2     |
|   4     | Ice song  |   Fantacy    |   8.6     |
|   5     | House card|   Interesting|   9.1     |
+---------+-----------+--------------+-----------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>For the example above, the output should be:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+---------+-----------+--------------+-----------+
|   id    | movie     |  description |  rating   |
+---------+-----------+--------------+-----------+
|   5     | House card|   Interesting|   9.1     |
|   1     | War       |   great 3D   |   8.9     |
+---------+-----------+--------------+-----------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="solutions-12"><a href="#solutions-12" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> cinema
<span class="token keyword">WHERE</span> <span class="token function">mod</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">AND</span> description <span class="token operator">!=</span> <span class="token string">'boring'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> RATING <span class="token keyword">DESC</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr> <h2 id="_627-swap-salary"><a href="#_627-swap-salary" aria-hidden="true" class="header-anchor">#</a> 627. Swap Salary</h2> <p>Given a table <code>salary</code>, such as the one below, that has m=male and f=female values. Swap all f and m values (i.e., change all f values to m and vice versa) with a single update query and no intermediate temp table.
For example:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>| id | name | sex | salary |
|----|------|-----|--------|
| 1  | A    | m   | 2500   |
| 2  | B    | f   | 1500   |
| 3  | C    | m   | 5500   |
| 4  | D    | f   | 500    |
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>After running your query, the above salary table should have the following rows:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>| id | name | sex | salary |
|----|------|-----|--------|
| 1  | A    | f   | 2500   |
| 2  | B    | m   | 1500   |
| 3  | C    | f   | 5500   |
| 4  | D    | m   | 500    |
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="solutions-13"><a href="#solutions-13" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> salary
<span class="token keyword">SET</span>
    sex <span class="token operator">=</span> <span class="token keyword">CASE</span> sex
        <span class="token keyword">WHEN</span> <span class="token string">'m'</span> <span class="token keyword">THEN</span> <span class="token string">'f'</span>
        <span class="token keyword">ELSE</span> <span class="token string">'m'</span>
    <span class="token keyword">END</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><hr> <h2 id="_596-classes-more-than-5-students"><a href="#_596-classes-more-than-5-students" aria-hidden="true" class="header-anchor">#</a> 596. Classes More Than 5 Students</h2> <p>There is a table <code>courses</code> with columns: <strong>student</strong> and <strong>class</strong></p> <p>Please list out all classes which have more than or equal to 5 students.</p> <p>For example, the table:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+---------+------------+
| student | class      |
+---------+------------+
| A       | Math       |
| B       | English    |
| C       | Math       |
| D       | Biology    |
| E       | Math       |
| F       | Computer   |
| G       | Math       |
| H       | Math       |
| I       | Math       |
+---------+------------+

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Should output:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+---------+
| class   |
+---------+
| Math    |
+---------+

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>Note:</strong>
The students should not be counted duplicate in each course.</p> <h2 id="solutions-14"><a href="#solutions-14" aria-hidden="true" class="header-anchor">#</a> Solutions</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    class
<span class="token keyword">FROM</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span>
        class<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> student<span class="token punctuation">)</span> <span class="token keyword">AS</span> num
    <span class="token keyword">FROM</span>
        courses
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> class<span class="token punctuation">)</span> <span class="token keyword">AS</span> temp_table
<span class="token keyword">WHERE</span>
    num <span class="token operator">&gt;=</span> <span class="token number">5</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    class
<span class="token keyword">FROM</span>
    courses
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> class
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> student<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">5</span>
<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">最近更新: </span> <span class="time">12/9/2018, 10:09:30 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Database/content.html" class="prev">
          数据库
        </a></span> <span class="next"><a href="/Database/MySQL/optimization.html">
          MySQL及索引优化
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/29.ac24f130.js" defer></script><script src="/assets/js/app.6b2c809f.js" defer></script>
  </body>
</html>
